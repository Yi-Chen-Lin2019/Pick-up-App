@model WebUI.ViewModels.BrowseViewModel
@using PagedList.Mvc;
<link href="~/Content/PagedList.css" rel="stylesheet" type="text/css" />

@*SEARCH_BOX*@
@using (Html.BeginForm("Search", "Product", FormMethod.Get))
{
    <div>
        @Html.TextBox("query")
        <input type="submit" value="Search" />
    </div>
}

@*SORTING_DROPDOWN*@

@{
    List<SelectListItem> sortingOptions = new List<SelectListItem>();
    sortingOptions.Add(new SelectListItem
    {
        Text = "Sort by",
        Value = ""
    });
    sortingOptions.Add(new SelectListItem
    {
        Text = "Price low-to-high",
        Value = "price_asc"
    });
    sortingOptions.Add(new SelectListItem
    {
        Text = "Price high-to-low",
        Value = "price_desc"
    });
    sortingOptions.Add(new SelectListItem
    {
        Text = "Name A-Z",
        Value = "name_desc"
    });
    sortingOptions.Add(new SelectListItem
    {
        Text = "Name Z-A",
        Value = "name_asc"
    });
}
@Html.DropDownList("sortDD", sortingOptions,
    new { @class = "form-control", @onchange = "document.location.href = '/Product/Index?sortOrder=' + this.options[this.selectedIndex].value;" })



<div class="col-lg-12">
    @*CATEGORY_LIST*@
    <div class="col-sm-2">
        @{
            IEnumerable<WebUI.ViewModels.CategoryViewModel> cats = Model.categories;
            foreach (var item in cats)
            {
                <div>
                    <input type="button" value="@item.name"
                           onclick="location.href='@Url.Action("Index", "Product")?category=' + @item.id" />
                </div>
            }
        }

    </div>
    <script>
        function addToCart(productId, price, name, image, isSNProduct) {
            var quantity = 0;
            if (isSNProduct == 'false') {
                quantity = parseInt(prompt("Please enter quantity", "1"));
            }
            else {
                quantity = 1;
            }


            if (quantity != null && quantity != NaN && quantity != 0) {
                $(function () {
                    $.post('/ShoppingCart/AddToCart',
                        { productId: productId, price: price, name: name, image: image, quantity: quantity, isSNProduct: isSNProduct }, function (data) {
                            if (data.success) {
                                alert("Item added to cart.");
                            }
                            else {
                                alert("Failure!");
                            }
                        });
                });
            }

        }
    </script>
    @*PRODUCT_LIST*@
    <div class="productList-container">
        @foreach (var item in Model.products)
        {
            <div class="productDisplay">
                <div class="product-photo">
                    @Html.Partial("~/Views/Product/Details.cshtml", item)
                </div>
                <div class="product-title">
                    <p style="font-size: 20px;">&nbsp @item.name</p>
                    <p style="font-size: 14px;">&nbsp @String.Format("{0:0.00} DKK", item.price)</p>
                </div>
            </div>
        }
    </div>
</div>
@Html.PagedListPager(Model.products, page => Url.Action("Index", new { page }))

